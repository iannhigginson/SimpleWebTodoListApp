_.ready(()=>{_.get("php/listTasks.php",e=>{e=e.trim();var d,b,a,c,f;let k=document.getElementById("todoTbl");JSON.parse(e).forEach(g=>{f=document.createElement("tr");c=document.createElement("td");b=document.createElement("input");b.note=`${g.project}`;b.setAttribute("onchange","checkboxChange(this)");b.type="checkbox";b.value=`${g.rid}`;b.checked="1"===g.done?!0:!1;c.appendChild(b);f.appendChild(c);c=document.createElement("td");c.innerHTML="&nbsp;";f.appendChild(c);c=document.createElement("td");
c.setAttribute("nowrap","nowrap");a=document.createElement("label");a.innerText=g.project;c.appendChild(a);f.appendChild(c);c=document.createElement("td");c.innerHTML="&nbsp;";f.appendChild(c);c=document.createElement("td");a=document.createElement("label");a.innerText=g.note;switch(g.priority){case "1":a.classList.add("yellowTextBold");break;case "2":a.classList.add("yellowText");break;default:a.classList.add("whiteText")}"1"===g.done?a.classList.add("strikeThrough"):a.classList.remove("strikeThrough");
c.appendChild(a);f.appendChild(c);c=document.createElement("td");c.innerHTML="&nbsp;";f.appendChild(c);c=document.createElement("td");d=document.createElement("button");d.innerText="Edit";d.setAttribute("class","button-2");d.setAttribute("onclick","editThis(this)");c.appendChild(d);f.appendChild(c);c=document.createElement("td");c.innerHTML="&nbsp;";f.appendChild(c);c=document.createElement("td");d=document.createElement("button");d.innerText="Delete";d.setAttribute("class","button-2");d.setAttribute("onclick",
`deleteThis('${g.rid}')`);c.appendChild(d);f.appendChild(c);k.appendChild(f)})})});
function addItem(){let e=document.getElementById("todoTbl");var d=document.createElement("tr");var b=document.createElement("td");b.innerHTML="&nbsp;";d.appendChild(b);b=document.createElement("td");b.innerHTML="&nbsp;";d.appendChild(b);b=document.createElement("td");var a=document.createElement("label");a.innerText="Project";b.appendChild(a);a=document.createElement("br");b.appendChild(a);a=document.createElement("input");a.id="project";a.size="5";a.type="text";a.value="";b.appendChild(a);d.appendChild(b);
b=document.createElement("td");b.innerHTML="&nbsp;";d.appendChild(b);b=document.createElement("td");a=document.createElement("label");a.innerText="Note";b.appendChild(a);a=document.createElement("br");b.appendChild(a);a=document.createElement("textarea");a.cols="50";a.rows="1";a.id="note";a.size="50";b.appendChild(a);d.appendChild(b);b=document.createElement("td");b.innerHTML="&nbsp;";d.appendChild(b);b=document.createElement("td");a=document.createElement("label");a.innerText="priority";b.appendChild(a);
a=document.createElement("br");b.appendChild(a);a=document.createElement("input");a.id="priority";a.size="5";a.type="number";a.value="";b.appendChild(a);d.appendChild(b);b=document.createElement("td");b.innerHTML="&nbsp;";d.appendChild(b);b=document.createElement("td");a=document.createElement("button");a.innerText="Save";a.setAttribute("class","button-2");a.setAttribute("onclick","saveThis()");b.appendChild(a);d.appendChild(b);e.insertBefore(d,e.childNodes[2]);document.getElementById("project").focus()}
function checkboxChange(e){let d=e.value,b=e.parentNode.parentNode.querySelectorAll("label");!0===e.checked?(b.forEach(a=>{a.classList.add("strikeThrough")}),e={id:d,done:!0}):(b.forEach(a=>{a.classList.remove("strikeThrough")}),e={id:d,done:!1});_.post("php/taskDone.php",JSON.stringify(e),a=>{a=a.trim();console.info(a);document.location.href="/"})}
function editThis(e){console.clear();var d,b,a,c,f,k,g,h,l;let p=e.parentNode.parentNode.querySelector("input[type=checkbox]");_.post("php/listTasks.php",JSON.stringify({rid:p.value}),n=>{n=n.trim();JSON.parse(n).forEach(m=>{a=e.parentNode.parentNode.querySelectorAll("button");tds=e.parentNode.parentNode.querySelectorAll("label");l=tds[1].parentNode;l.innerHTML="";c=document.createElement("input");c.id="project";c.type="hidden";c.value=m.project;l.appendChild(c);f=document.createElement("label");
f.innerText="Note";l.appendChild(f);d=document.createElement("br");l.appendChild(d);h=document.createElement("textarea");h.cols="50";h.rows="1";h.id="note";h.size="50";h.title="Press Ctrl End key to place the curson at the end if the content.";h.innerText=m.note;l.appendChild(h);k=a[0].parentNode;k.innerHTML="";f=document.createElement("label");f.innerText="priority";k.appendChild(f);d=document.createElement("br");k.appendChild(d);c=document.createElement("input");c.id="priority";c.size="5";c.type=
"number";c.value=m.priority;k.appendChild(c);g=a[1].parentNode;g.innerHTML="";b=document.createElement("button");b.innerText="Save";b.setAttribute("class","button-2");b.setAttribute("onclick",`updateThis('${m.rid}')`);g.appendChild(b)});document.getElementById("note").focus()})}function deleteThis(e){console.info(e);!0===confirm("Are you sure you want to delete this")&&_.post("php/deleteThis.php",JSON.stringify({rid:e}),d=>{d=d.trim();console.info(d);document.location.href="/"})}
function saveThis(){let e=document.getElementById("project").value,d=document.getElementById("note").value,b=document.getElementById("priority").value;_.post("php/saveThis.php",JSON.stringify({project:e,note:d,priority:b,done:0}),a=>{a=a.trim();console.log(a);document.location.href="/"})}
function updateThis(e){let d=document.getElementById("project").value,b=document.getElementById("note").value,a=document.getElementById("priority").value;_.post("php/updateThis.php",JSON.stringify({rid:e,project:d,note:b,priority:a,done:0}),c=>{c=c.trim();console.log(c);document.location.href="/"})}function sc(e,d,b){var a="";b&&(a=new Date,a.setTime(a.getTime()+864E5*b),a=`expires=${a.toUTCString()}`);document.cookie=`${e}=${d}; ${a}; path=/`;console.info(document.cookie)}
function gc(e){e+="=";for(var d=document.cookie.split(";"),b=0;b<d.length;b++){for(var a=d[b];" "===a.charAt(0);)a=a.substring(1);if(-1!==a.indexOf(e))return a.substring(e.length,a.length)}return""};
